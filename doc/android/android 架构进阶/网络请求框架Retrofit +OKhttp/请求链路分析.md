1：retrofit 创建

```java
private synchronized static Retrofit ensureInstance(String baseUrl) {
        Retrofit retrofit = sRetrofitMap.get(baseUrl);
        if (retrofit == null) {
            retrofit = new Retrofit.Builder().baseUrl(baseUrl)
                    .client(OkHttpClientHolder.getOkHttpClient())//设置OkhttpClient 端
                    .addConverterFactory(GsonConverterFactory.create(GsonHolder.getGson()))//设置数据转换工厂
                    .callbackExecutor(ExecutorUtils.WORKING_EXECUTOR)//设置运行线程
                    .build();
            sRetrofitMap.put(baseUrl, retrofit);
        }
        return retrofit;//返回retrofit 对象
    }
```

2：gson 创建

```java
 public static Gson getGson() {
        if (mGson == null) {
            synchronized (GsonHolder.class) {
                if (mGson == null) {
                    mGson = new GsonBuilder()
                        	//设置元素转换适配器
                            .registerTypeAdapter(IntegerDeserializer.class, new IntegerDeserializer())
                            .registerTypeAdapter(SplashAdInfo.AdRect.class, SplashAdInfo.getAdRectDeserializer())
                            .registerTypeAdapter(PushAdInfo.PushTriggerData.class,
                                    new PushAdInfo.PushTriggerDataDeserializer())
                            .create();
                }
            }
        }
        return mGson;
    }

//string 转换为 int
    static class IntegerDeserializer implements JsonDeserializer<Integer> {
        private static final String TAG = "IntHolderDeserializer";

        @Override
        public Integer deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context)
                throws JsonParseException {
            Integer value = 0;
            try {
                if (json.isJsonPrimitive()) {
                    value = json.getAsInt();
                    MLog.i(TAG, "JsonPrimitive: " + value);
                }
            } catch (Exception e) {
                MLog.e(TAG, "deserialize exception", e);
            }
            return value;
        }
    }
```

